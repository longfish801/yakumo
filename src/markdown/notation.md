# yakumo記法

[TOC levels=2-6]

## 概要

　yakumoにはサンプルとして以下の変換資材を用意しています。

fyakumo
: yakumo記法に従うテキストをbltxt記法に変換します。

thtml
: bltxt文書をHTML5に変換します。

　以下、どのようにyakumo記法をbltxt記法に、そしてbltxt記法をHTMLへ変換するか説明します。

## 改行と段落

　連続する行をひとつの段落とみなします。
　空行が段落区切りとなります。
　空行が複数あってもひとつの空行と同じ扱いになります。

　以下のテキストがあったとします。

```
　おいしいカレーを作るには隠し味が大切です。
　隠し味にもいろいろなものがあります。


　一般家庭で良く使われる隠し味を試してみましょう。
```

　以下のHTMLに変換します。
　改行は brタグを挿入します。段落は pタグで囲みます。

```
<p>　おいしいカレーを作るには隠し味が大切です。<br/>
　隠し味にもいろいろなものがあります。</p>

<p>　一般家庭で良く使われる隠し味を試してみましょう。</p>
```

　以下の行範囲タグの変換時はbrタグのみ挿入します。

* 見出し、小見出し
* 箇条書き

　以下の行範囲タグの変換時はbrタグ、pタグを付与しません。

* 整形済
* コード

## HTML文法上の特殊文字の扱い

　HTML文法上の特殊文字はそのまま使うことができます。

```
　もし、あのとき"あれ"があったなら。
　極上の<カレー>になっていたかもしれない。
```

　以下のHTMLに変換します。
　HTML文法上の特殊文字は実体参照に置き換えます。

```
<p>　もし、あのとき&quot;あれ&quot;があったなら。<br/>
　極上の&lt;カレー&gt;になっていたかもしれない。</p>
```

## タイトル、サブタイトル、公開日、著者名

　タイトル、サブタイトル、公開日、著者名は、含意タグで指定します。
　省略可能です。

```
【＃タイトル】円周率について
【＃サブタイトル】著名な語呂合わせ
【＃公開日】2022.02.03
【＃著者名】山田太郎
```

　以下のHTMLに変換します。
　タイトルはheaderタグ内のtitleタグにも記述します。
　タイトルの指定がないときはデフォルトで「（無題）」とします。

```
<header class="row px-3 py-5">
<div class="col-lg-8">
<h1>円周率について</h1>
<div id="subtitle">著名な語呂合わせ</div>
</div>
<div class="col-lg-4 text-end">
<div id="pubdate">公開日 2022.02.03</div>
<div id="author">山田太郎</div>
</div>
</header><!-- endo of row -->
```

## ブロック要素
### 見出し

　yakumo記法の糖衣構文で見出しを表現できます。
　行頭に「■」「□」「▼」があれば、見出しとみなします。

```
■おいしいカレーの作り方
□材料の準備
▼牛の飼い方
```

　上記を以下のbltxt文書に変換します。

```
【＝見出し】おいしいカレーの作り方
【＝見出し：2】材料の準備
【＝見出し：3】牛の飼い方
```

　以下のHTMLに変換します。
　タイトルを h1とする関係上、レベル1が h2、レベル2が h3……となります。
　目次からページ内リンクで移動できるよう、aタグを挿入します。
　name属性は、bltxt文書を XML化したときの snum属性を利用します。

```
<h2><a name="1">おいしいカレーの作り方</a></h2>
<h3><a name="2">材料の準備</a></h3>
<h4><a name="3">牛の飼い方</a></h4>
```

　併せて目次を生成します。

```
<nav class="col-lg-4">
<ul class="nav flex-column">
<li class="nav-item toc_h2"><a href="#id2_1" class="nav-link">おいしいカレーの作り方</a></li>
<li class="nav-item toc_h3"><a href="#id3_2" class="nav-link">材料の準備</a></li>
<li class="nav-item toc_h4"><a href="#id4_3" class="nav-link">牛の飼い方</a></li>
</ul>
</nav>
```

### 箇条書き

　yakumo記法の糖衣構文で箇条書きを表現できます。
　一文字目に中黒（・）があれば、箇条書きとみなします。
　半角空白でインデントすることで、複数行を記述できます。
　項目の間に空行があっても無視します。
　箇条書きを終了するには、空行の後に中黒始まりではない行を記述してください。

```
・じゃがいも
・ニンジンを、
  二本。

・玉ねぎ
```

　上記を以下のbltxt文書に変換します。

```
【－箇条書き】
【－項目】
じゃがいも
【項目－】
【－項目】
ニンジンを、
二本。
【項目－】
【－項目】
玉ねぎ
【項目－】
【箇条書き－】
```

　入れ子にすることもできます。

```
・じゃがいも
・ニンジン
・玉ねぎ
  ・刻むときは注意。
    涙がでます。
・カレー粉
  ・ジャワカレー
  ・バーモンドカレー
```

　上記を以下のbltxt文書に変換します。

```
【－箇条書き】
【－項目】
じゃがいも
【項目－】
【－項目】
ニンジン
【項目－】
【－項目】
玉ねぎ
【－箇条書き】
【－項目】
刻むときは注意。
涙がでます。
【項目－】
【箇条書き－】
【項目－】
【－項目】
カレー粉
【－箇条書き】
【－項目】
ジャワカレー
【項目－】
【－項目】
バーモンドカレー
【項目－】
【箇条書き－】
【項目－】
【箇条書き－】
```

　以下のHTMLに変換します。

```
<ul>
<li>じゃがいも</li>
<li>ニンジン</li>
<li>玉ねぎ
	<ul>
	<li>刻むときは注意。<br/>
	涙がでます。</li>
	</ul></li>
<li>カレー粉
	<ul>
	<li>ジャワカレー</li>
	<li>バーモンドカレー</li>
	</ul></li>
</ul>
```

### コラム

　行範囲タグでコラムを表現できます。

```
【－コラム】
　日本人の四割は血液型がＯ型です。
【コラム－】
```

　以下のHTMLに変換します。
　asideタグ（class属性値は"column"）を生成します。

```
<aside class="panel panel-primary">
<p>　日本人の四割は血液型がＯ型です。</p>
</aside>
```

　第一属性に小見出しを指定することもできます。

```
【－コラム：８月３１日はなんの日？】
　８月３１日は野菜の日です。
　野菜を食べましょう。
【コラム－】
```

　以下のHTMLに変換します。

```
<aside class="alert alert-success" role="alert">
<header class="alert-heading"><i class="bi bi-info-circle-fill"></i> ８月３１日はなんの日？</header>
<p>　８月３１日は野菜の日です。<br/>
　野菜を食べましょう。</p>
</aside>
```

### 注意

　行範囲タグで注意喚起のためのコラムを表現できます。
　第一属性に小見出しを指定することもできます。

```
【－注意：中火とは】
　中火とは、フライパンの底に炎の先端がちょうど届くくらいの状態を指します。
【注意－】
```

　以下のHTMLに変換します。
　asideタグ（class属性値は"attention"）を生成します。

```
<aside class="alert alert-danger" role="alert">
<header class="alert-heading"><i class="bi bi-exclamation-triangle-fill"></i> 中火とは</header>
<p>　中火とは、フライパンの底に炎の先端がちょうど届くくらいの状態を指します。</p>
</aside>
```

### 引用、引用元

　yakumo記法の糖衣構文で引用を表現できます。
　必要であれば引用元を行タグで記述します。

```
=====
　山路を登りながら、こう考えた。
　智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。
【＝引用元】夏目漱石『草枕』
=====
```

　上記を以下のbltxt文書に変換します。

```
【－引用】
　山路を登りながら、こう考えた。
　智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。
【＝引用元】夏目漱石『草枕』
【引用－】
```

　以下のHTMLに変換します。

```
<blockquote>
<p>　山路を登りながら、こう考えた。<br/>
　智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。</p>
<footer><cite>夏目漱石『草枕』</cite></footer>
</blockquote>
```

### コード

　yakumo記法の糖衣構文でコードを表現できます。
　５つの半角ハイフンを区切り行として、コードを記述できます。

```
-----
println "Hello, World!";
println "This is sample code of how to hello to all of the world, which is executed " + Date().format("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
-----
```

　上記を以下のbltxt文書に変換します。

```
【－コード】
println "Hello, World!";
println "This is sample code of how to hello to all of the world, which is executed " + Date().format("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
【コード－】
```

　以下のHTMLに変換します。
　preタグを生成します。

```
<pre>
println &quot;Hello, World!&quot;;
println &quot;This is sample code of how to hello to all of the world, which is executed &quot; + Date().format(&quot;yyyy-MM-dd'T'HH:mm:ss.SSSZ&quot;);
</pre>
```

### 画像

　行タグで画像を表現できます。
　属性に画像の説明、画像ファイルへのパスを指定してください。

```
【＝画像：猫ちゃん：cutecat.png】
```

　画像にキャプションを付与することもできます。

```
【＝画像：猫ちゃん：cutecat.png】猫ちゃん、可愛い～
```

　以下のHTMLに変換します。

```
<figure class="text-center">
<img src="cutecat.png" class="img-fluid" alt="猫ちゃん">
<figcaption>猫ちゃん、可愛い～</figcaption>
</figure>
```

### 註、註記

　註は文中タグで、注記は含意範囲タグで記述します。
　一番目の属性に、紐付けのため共通する文字列を指定してください。

```
　XML【註：XML】をHTML【註：HTML】に変換します。

【＊註記：XML】
　eXtensible Markup Languageの略です。
【註記＊】
【＊註記：HTML】
　Hyper Text Markup Languageの略です。
【註記＊】
```

　HTML変換時に通番をふります。

```
<p>　XML<sup><a id="f1" href="#t1">*1</a></sup>をHTML<sup><a id="f2" href="#t2">*2</a></sup>に変換します。</p>

<dl class="note">
<dt><a name="t1" href="#f1">[*1]</a></dt>
<dd>　eXtensible Markup Languageの略です。</dd>
<dt><a name="t2" href="#f2">[*2]</a></dt>
<dd>　Hyper Text Markup Languageの略です。</dd>
</dl>
```

### マスキング

　yakumo記法の糖衣構文で、switemスクリプトによる整形の対象外としたい文章を表現できます。

```
【－マスキング】
・帰りに綿棒を買ってくること。
【マスキング－】
```

　上記を以下のbltxt文書に変換します。
　本来なら箇条書きとして整形されるはずですが、マスキングしているため処理の対象外となっています。
　行範囲タグは削除されることにご注意ください。

```
・帰りに綿棒を買ってくること。
```

## インライン要素
### リンク

　yakumo記法の糖衣構文でリンクを表現できます。
　一番目の属性にリンクとして表示する文字列を、二番目の属性にリンク先アドレスを指定してください。
　一番目の属性のみ指定した場合は、表示する文字列とリンク先アドレスを同じ値とみなします。

```
　詳しくは【リンク：ネット検索：https://www.google.com/】してください。
　【リンク：https://www.google.com/】でネット検索できます。
```

　上記を以下のbltxt文書に変換します。

```
　詳しくは【｜リンク：https://www.google.com/】ネット検索【リンク｜】してください。
　【｜リンク：https://www.google.com/】https://www.google.com/【リンク｜】でネット検索できます。
```

　以下のHTMLに変換します。

```
<p>　詳しくは<a href="https://www.google.com/">ネット検索</a>してください。<br/>
　<a href="https://www.google.com/">https://www.google.com/</a>でネット検索できます。</p>
```

　また、URLのみが記述された行も変換します。

```
https://www.google.com/
```

　上記を以下のbltxt文書に変換します。

```
【｜リンク：https://www.google.com/】https://www.google.com/【リンク｜】
```

### 重要

　yakumo記法の糖衣構文で重要な記述を表現できます。
　重要な箇所を属性に指定します。

```
　間違えて【重要：自爆スイッチ】を押さないでください。
```

　上記を以下のbltxt文書に変換します。

```
　間違えて【｜重要】自爆スイッチ【重要｜】を押さないでください。
```

　以下のHTMLに変換します。

```
<p>　間違えて<strong>自爆スイッチ</strong>を押さないでください。</p>
```

### 補足

　yakumo記法の糖衣構文で補足を表現できます。
　補足する箇所を属性に指定します。

```
　もちろん本当【補足：かもしれない】ですよ。
```

　上記を以下のbltxt文書に変換します。

```
　もちろん本当【｜補足】かもしれない【補足｜】ですよ。
```

　以下のHTMLに変換します。

```
<p>　もちろん本当<small>かもしれない</small>ですよ。</p>
```

### 訂正

　yakumo記法の糖衣構文で訂正を表現できます。
　訂正する対象を属性に指定します。

```
　富士山の標高は【訂正：３７７７メートル】３７７６メートルです。
```

　上記を以下のbltxt文書に変換します。

```
　富士山の標高は【｜訂正】３７７７メートル【訂正｜】３７７６メートルです。
```

　以下のHTMLに変換します。
　sタグを生成します。

```
<p>　富士山の標高は<s>３７７７メートル</s>３７７６メートルです。</p>
```

### 縦中横

　yakumo記法の糖衣構文で縦中横を表現できます。
　縦中横にする対象を属性に指定します。

```
　シェイクスピア全集の第【縦中横：10】巻に記述されています。
```

　上記を以下のbltxt文書に変換します。

```
　シェイクスピア全集の第【｜縦中横】10【縦中横｜】巻に記述されています。
```

　HTML5は縦書きや縦中横には対応していないため、HTMLタグへの変換はしません。

```
<p>　シェイクスピア全集の第10巻に記述されています。</p>
```

### 傍点

　yakumo記法の糖衣構文で傍点を表現できます。
　傍点を打つ対象を属性に指定します。

```
　まだ【傍点：午前三時】じゃないか。
```

　上記を以下のbltxt文書に変換します。

```
　まだ【｜傍点】午前三時【傍点｜】じゃないか。
```

　以下のHTMLに変換します。
　傍点のためのHTMLタグは無いため、spanタグを利用しています。

```
<p>　まだ<span class="dot">午前三時</span>じゃないか。</p>
```

### ルビ

　yakumo記法の糖衣構文でルビを表現できます。
　一番目の属性にルビをふる対象を、二番目の属性にルビを指定します。

```
　【ルビ：出納：すいとう】係は言った。
```

　上記を以下のbltxt文書に変換します。

```
　【｜ルビ：すいとう】出納【ルビ｜】係は言った。
```

　以下のHTMLに変換します。

```
<p>　<ruby>出納<rp>［</rp><rt>すいとう</rt><rp>］</rp></ruby>係は言った。</p>
```

